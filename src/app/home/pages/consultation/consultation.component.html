<div class="container-fluid p-3" #main>

  <!--
  <div class="col-md-2"></div>
  <div class="mt-4 col-md-9">
    <div class="row">
      <div class="col-8">
        <form class="example-form">
          <mat-form-field class="example-full-width">
            <mat-label>Search Doctor</mat-label>
            <input matInput class="bg-white" >
            <mat-icon matSuffix style="align-self: center;">search</mat-icon>
          </mat-form-field>
        </form>
      </div>
    </div>
  </div>
  -->
  <div class="row">
    <div class="col-2"></div>
    <div class="col-md-7 ">
      <div style="display:flex;border-radius: 5px;overflow: hidden;background: #fff;;">
        <div class="city-box">
          <mat-icon matPrefix style="align-self: center;color: #e7e7e7;margin-right: 5px;cursor: pointer;"
            (click)="setCurrentLocation()">room</mat-icon>
          <div class="input-group no-border city">
            <input type="text" placeholder="city" matInput [formControl]="myControl" [matAutocomplete]="autoCity">
            <mat-autocomplete #autoCity="matAutocomplete">
              <mat-option *ngFor="let option of filteredCities | async" [value]="option">
                {{option}}
              </mat-option>
            </mat-autocomplete>
          </div>
        </div>
        
        <div class="search-box">     
          <div class="input-group no-border">
            <input
              [formControl]="myDoctorControl"
              [(ngModel)]="searchBarMain"
              class="search-box-input" 
              type="text" 
              #toggleButton
              placeholder= "Search Doctor"
              [matAutocomplete]="auto"
            >
            <div>
              <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" >
                <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
                  {{option}}
                </mat-option>
              </mat-autocomplete>
            </div>
            <div *ngIf="false">
              <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" >
                <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
                  {{option}}
                </mat-option>
              </mat-autocomplete>
            </div>
          </div>
          <div class="consultation">
            <mat-form-field style="padding-top: 4px" appearance="standard">
              <mat-select  (selectionChange)="searchByFunction($event)">
                <mat-option value="" disabled>Select</mat-option>
                <mat-option value="name">Search by name</mat-option>
                <mat-option value="speciality">Search by speciality</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <mat-icon matSuffix class="search-icon" style="align-self: center;" (click)=" searchBar()">search</mat-icon>
        </div>
      </div>   
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-md-12 consultation-main">   
      <mat-toolbar color="primary" class="top-navbar" style="min-width : 1270px">
        
        <div class=" mt-1">
          <button  *ngIf="filters.stream.length == 0" class="filter" mat-flat-button [matMenuTriggerFor]="streamMenu">Stream <mat-icon>keyboard_arrow_down</mat-icon></button>
          
          <button *ngIf="filters.stream.length != 0" class="filter" mat-flat-button [matMenuTriggerFor]="streamMenu">
            {{filters.stream[0]}} <span *ngIf="filters.stream.length > 1">+ {{filters.stream.length - 1}}</span>
            <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
          
        </div>
        <div class=" mt-1">
          <button *ngIf="filters.speciality.length == 0" class="filter" mat-flat-button [matMenuTriggerFor]="specialityMenu">Speciality <mat-icon>keyboard_arrow_down</mat-icon></button>
          <button *ngIf="filters.speciality.length != 0" class="filter" mat-flat-button [matMenuTriggerFor]="specialityMenu">
            {{filters.speciality[0]}} <span *ngIf="filters.speciality.length > 1">+ {{filters.speciality.length - 1}}</span>
            <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
        </div>
        <div class=" mt-1">
          <button *ngIf="filters.gender.length == 0"  class="filter" mat-flat-button [matMenuTriggerFor]="genderMenu">Gender <mat-icon>keyboard_arrow_down</mat-icon></button>
          <button *ngIf="filters.gender.length != 0"  class="filter" mat-flat-button [matMenuTriggerFor]="genderMenu">
            {{filters.gender[0]}} <span *ngIf='filters.gender.length > 1'> + {{filters.gender.length - 1}}</span>
            <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
        </div>
        <div class=" mt-1">
          <button class="filter" mat-flat-button [matMenuTriggerFor]="experienceMenu">Experience <mat-icon>keyboard_arrow_down</mat-icon></button>
        </div>
        <div class=" mt-1">
          <button *ngIf="filters.fromHealthcrum == null" class="filter" mat-flat-button [matMenuTriggerFor]="healthcrumMenu">Type of doctor <mat-icon>keyboard_arrow_down</mat-icon></button>
          <button *ngIf="filters.fromHealthcrum != null" class="filter" mat-flat-button [matMenuTriggerFor]="healthcrumMenu">
            {{filters.fromHealthcrum ? 'Healthcrum Doc' : 'Non Healthcrum' }} 
            <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
        </div>
        <div class=" mt-1">
          <button  *ngIf="consFilterLength == 0" class="filter" mat-flat-button [matMenuTriggerFor]="consultationMenu">consultation <mat-icon>keyboard_arrow_down</mat-icon></button>
          <button  *ngIf="consFilterLength != 0" class="filter" mat-flat-button [matMenuTriggerFor]="consultationMenu">
            {{consultationToshow | titlecase}} <span *ngIf="consFilterLength > 1"> + {{consFilterLength - 1}}</span>
            <mat-icon>keyboard_arrow_down</mat-icon></button>
        </div>
        
        <div class=" mt-1">
          <button *ngIf="filters.rating.length == 0"  class="filter" mat-flat-button [matMenuTriggerFor]="ratingMenu">Rating <mat-icon>keyboard_arrow_down</mat-icon></button>
          <button *ngIf="filters.rating.length != 0"  class="filter" mat-flat-button [matMenuTriggerFor]="ratingMenu">
            {{filters.rating[0]}} star <span *ngIf="filters.rating.length > 1"> + {{filters.rating.length - 1}}</span>
           <mat-icon>keyboard_arrow_down</mat-icon></button>
        </div>
        <div class=" mt-1">
          <button  *ngIf="!sorting" class="filter" mat-flat-button [matMenuTriggerFor]="sortMenu">Sort By
            <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
          <button  *ngIf="sorting" class="filter" mat-flat-button [matMenuTriggerFor]="sortMenu">{{sortDisplay}}
            <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
        </div>
            
        
        
        <mat-menu #streamMenu ="matMenu">
          <!--
          <button mat-menu-item (click)="getStream('Ayurveda')" >Ayurvedic</button>
          <button mat-menu-item (click)="getStream('Allopathic')">Allopathic</button>
          <button mat-menu-item (click)="getStream('Homeophathic')">Homeophathic</button>
          -->
          <div class="filter-checkbox">
            <mat-checkbox  (change)="getStream('Ayurveda')">Ayurveda</mat-checkbox>
            <mat-checkbox (change)="getStream('Allopathic')">Allopathic</mat-checkbox>
            <mat-checkbox (change)="getStream('Homeophathic')">Homeophathic</mat-checkbox>
          </div>
            
        </mat-menu>
        
        <mat-menu #specialityMenu ="matMenu">
          <!--
          <button mat-menu-item (click)="getSpeciality('Heart')">Heart Specialist</button>
          <button mat-menu-item (click)="getSpeciality('skin')">Skin Speciality</button>
          <button mat-menu-item (click)="getSpeciality('lung')">Lungs Speciality</button>
          <button mat-menu-item (click)="getSpeciality('dentist')">Dentist</button>
          -->
          <div class="filter-checkbox">
            
            <mat-checkbox  (change)="getSpeciality('Heart')">Heart</mat-checkbox>
            <mat-checkbox (change)="getSpeciality('skin')">Skin</mat-checkbox>
            <mat-checkbox (change)="getSpeciality('lung')">Lungs</mat-checkbox>
            <mat-checkbox (change)="getSpeciality('dentist')">Liver</mat-checkbox>
          
          </div>
        </mat-menu>

        <mat-menu #genderMenu ="matMenu">
          <div class="filter-checkbox">
            <mat-checkbox  (change)="getGender('male')">Male</mat-checkbox>
            <mat-checkbox (change)="getGender('female')">Female</mat-checkbox>
            <mat-checkbox (change)="getGender('others')">Others</mat-checkbox>
              
          </div>
        </mat-menu>

        <mat-menu #experienceMenu ="matMenu">
          <button mat-menu-item (click)="getExperience(0 ,2, 'Below 2 years')">Below 2 years</button>
          <button mat-menu-item (click)="getExperience(2 , 5, '2 years to 5 years')">2 years to 5 years</button>
          <button mat-menu-item (click)="getExperience(5 , 10, '5 years to 10 years')">5 years to 10 years</button>
          <button mat-menu-item (click)="getExperience(10 , 100, 'Above 10 years')">Above 10 years</button>
        </mat-menu>

        <mat-menu #healthcrumMenu ="matMenu">
          
          <div class="filter-checkbox">
            
            <mat-checkbox [(ngModel)]='filterHealthcrum1' (change)="getDoctorType(true)">Healthcrum Doctor</mat-checkbox>
            <mat-checkbox [(ngModel)]='filterHealthcrum2' (change)="getDoctorType(false)">Other Doctor</mat-checkbox>
            
          
          </div>
        </mat-menu>

        <mat-menu #consultationMenu ="matMenu">
          <div class="filter-checkbox">
       
            <mat-checkbox (change)="getConsultation($event, 'tele')">Telephonic consultation</mat-checkbox>
            <mat-checkbox (change)="getConsultation($event, 'video')">Video consultation</mat-checkbox>
            <mat-checkbox (change)="getConsultation($event, 'physical')">Physical consultation</mat-checkbox>
            <mat-checkbox (change)="getConsultation($event, 'emergency')">Emergency consultation</mat-checkbox>
              
          </div>

        </mat-menu>

        <mat-menu #ratingMenu ="matMenu">
          <div class="filter-checkbox">
       
            <mat-checkbox (change)="getRating(1)">1 start</mat-checkbox>
            <mat-checkbox (change)="getRating(2)">2 start</mat-checkbox>
            <mat-checkbox (change)="getRating(3)">3 start</mat-checkbox>
            <mat-checkbox (change)="getRating(4)">4 start</mat-checkbox>
            <mat-checkbox (change)="getRating(5)">5 start</mat-checkbox>

          </div>
        </mat-menu>

        <mat-menu #sortMenu ="matMenu">
          <button mat-menu-item (click)="sort(true)">Low to high</button>
          <button mat-menu-item (click)="sort(false)">High to low</button>
         
        </mat-menu> 

      </mat-toolbar>
    </div>
  </div>

  <div class="row">
    <div *ngIf = "containDoctor" class="col-md-9" >
      <div class="col-12">
        <div class="row" *ngIf="!horizontal">
          <div 
            class="col-md-6 col-lg-4 mt-4  mt-3 ml-0 mb-4 "
          *ngFor="let doctor of doctors; let i = index" >    
            <div class="row">
              <div class="col-12 ">
                  <mat-card  class=" doctor-card" style="padding-top : 0">  
                    <div class="row feedback-horizontal">
                      <i class="material-icons" [ngClass]="i < rating ? 'active-feedback' : 'passive-feedback' " 
                      *ngFor="let star of ratingArray; let i = index">grade</i>
                      <div class="logo-div">
                        <img
                          src="{{doctor.logo}}"
                          class="logo"
                        >
                      </div>  
                    </div>
                    <div class="row">
                      <div class="col-12 doctor-image">
                        <img src={{doctor.profilepic}} 
                        alt="loading..."                         
                        class="center img-circle">
                      </div>
                    </div>
                    <div class="row mt-0">
                      <div class="col-md-12 doctor-name mt-0">
                        <h4 class=" m-0 ">{{doctor.name}}</h4>
                      </div>
                    </div>
                    <div class="row mt-2">
                      <div class="col-4 text-center">
                      
                        {{doctor.speciality}}
                      </div>
                      <mat-divider [vertical]="true"></mat-divider>
                      <div class="col-4 text-center">
                      
                        <label style="color : black" *ngFor="let deg of doctor.qualification">{{deg | uppercase}}</label>
                      </div>
                      <mat-divider [vertical]="true"></mat-divider>
                      <div class="col-3 text-center">
                    
                      {{doctor.experience}}+</div>
                    </div>
                    <div class="row mt-1 ml-1 mr-1">

                      <div class="col-12 consultation-port-new">
                        <div class="row"> 
                          <div class="col-12">
                            <label class="consultation-label-top">
                              BOOK APPOINTMENT
                            </label>
                          </div>
                          <div class="col-12">
                            <label class="consultation-label-bottom">
                              Click Preferred Mode of Consultation
                            </label>
                          </div>
                        </div> 
                      </div>
                      <div class="col-12">
                        <div class="row">
                          <div class="col-3 cursor-pointer" style="padding : 0">
                            <div class="cursor-pointer" (click)="openDialog('video', i)">
                              <div>
                                <img
                                  src="./assets/img/consulation/blood-test/video.png"
                                  class="consultation-image-horizontal "
                                >
                              </div>
                              <div>
                                <label class="image-data">
                                  {{doctor.consultationTiming.video.from}} - {{doctor.consultationTiming.video.to}}
                                </label>
                              </div>
                            </div>
                          </div>
                          <div class="col-3 cursor-pointer" style="padding : 0">
                            <div  class=" cursor-pointer" (click)="openDialog('tele', i)">
                              <div>
                                <img
                                  src="./assets/img/consulation/blood-test/telephone.jpg"
                                  class="consultation-image-horizontal center"
                                >
                              </div>
                              <label class="image-data">
                                {{doctor.consultationTiming.tele.from}} - {{doctor.consultationTiming.tele.to}}
                              </label>
                            </div>
                          </div>
                          <div class="col-3 cursor-pointer" style="padding : 0">
                            <div  class=" cursor-pointer" (click)="openDialog('physical', i)">
                              <div>
                                <img
                                  src="./assets/img/consulation/blood-test/physicalMeeting.jpg"
                                  class="consultation-image-horizontal center"
                                >
                              </div>
                              <label class="image-data">
                                {{doctor.consultationTiming.physical.from}} - {{doctor.consultationTiming.physical.to}}
                              </label>
                            </div>
                          </div>
                          <div class="col-3 cursor-pointer"style="padding : 0">
                            <div class=" cursor-pointer" (click)="openDialog('chat', i)">
                              <div>
                                <img
                                  src="./assets/img/consulation/blood-test/phone.jpg"
                                  class="consultation-image-horizontal center"
                                >
                              </div>
                              <label class="image-data">
                                {{doctor.consultationTiming.chat.from}} - {{doctor.consultationTiming.chat.to}}
                              </label>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-12 emergency-section">
                        <div class="row">
                          <div class="col-5">
                            <div class="row mt-1">
                              <div class="col-md-12" style="padding : 0">
                                <label class="normal-fee-heading">
                                  Consultation Fee 
                                </label>
                              </div>
                              
                              <div class="col-md-4 normal-fee-cost">
                                Rs.{{doctor.consultationFees}}/-
                              </div>
                            </div>
                          </div>
                          <mat-divider [vertical]="true"></mat-divider>
                          <div class="col-6">
                            <div class="row ">
                              <div class="col-5 mt-1" style="padding : 0">
                                <img
                                  src="./assets/img/consulation/blood-test/emergency1.jpg"
                                  class="emergency-image-horizontal"
                                >
                              </div>
                              <div class="col-7 mt-1 cursor-pointer"  (click)="openDialog('emergency', i)">
                                <div class="row" class="cursor-pointer">
                                  <div class="col-12 emergency-fee mt-1" class="cursor-pointer">
                                    <label class="emergency-fee" tyle="font-size : smaller;padding-left: 15px;">Fee : {{doctor.emergencyFees}}</label>
                                  </div>
                                  <div class="col-12 emergency-time-div" class="cursor-pointer">
                                    <label class="emergency-time">24 hrs</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-12">
                        <div class="row">
                          <div class="col-6 mt-3">
                            <label style="color : black">City  : {{doctor.location.city | titlecase}}</label>
                          </div>
                          <div class="col-6">
                            <div class="row">
                              <div class="col-5">
                                <img
                                  src="./assets/img/consulation/blood-test/location.jpg"
                                  class="doctor-location-image"
                                >
                              </div>
                              <div class="col-7 mt-3">
                                5 KM
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-12">
                        <button class="btn btn-info booknow" (click)="knowMore(i)" ><mat-icon>control_point</mat-icon>View profile</button>
                      </div>
                    </div>
                    
                  </mat-card>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="horizontal">
          <div class="row horizontal-port mt-4" *ngFor="let doctor of doctors; let i = index"> 
            <div class="col-12">
              <mat-card  class=" doctor-card">  
                <div class="row ">
                  <div class="col-md-4 col-lg-3">
                    <div class="row feedback-horizontal">
                      <i class="material-icons" [ngClass]="ind <= rating ? 'active-feedback' : 'passive-feedback' " 
                      *ngFor="let star of ratingArray let ind = index">grade</i> 
                    </div>
                    <div class="row">
                      <div class="col-12 doctor-image">
                        <img src={{doctor.profilepic}} 
                        alt="loading..."                         
                        class=" img-circle">
                      </div>
                    </div>
                  </div>

                  <div class="col-md-4">
                    <div class="row mt-0">
                      <div class="col-md-12 doctor-name mt-0">
                        <h4 class=" m-0 ">{{doctor.name }}</h4>
                      </div>
                    </div>
                    <div class="row mt-4">
                      
                      <div class="col-4 text-center">
                        {{doctor.speciality | titlecase }}
                      </div>
                      <mat-divider [vertical]="true"></mat-divider>
                      <div class="col-4 text-center">
                        <label style="color : black" *ngFor="let deg of doctor.qualification">{{deg | titlecase}}</label>
                      </div>
                      
                      <mat-divider [vertical]="true"></mat-divider>
                      <div class="col-3 text-center">
                      {{doctor.experience}} years</div>
                    </div>
        
                    <div class="row mt-3">
                      <div class="col-4 text-center">
                      {{doctor.location.city | titlecase}}
                      </div>
                      <mat-divider [vertical]="true"></mat-divider>
                      <div class="col-4 text-center">
                        5 Km
                      </div>
                      <mat-divider [vertical]="true"></mat-divider>
                      <div class="col-3 text-center">
                        <img
                          src="./assets/img/consulation/blood-test/location.jpg"
                          class="horizontal-location"
                        >
                      </div>
                    </div>
                  </div>

                  <div class="col-5 consultation-horizontal">
                    <div class="row consultation-div-horizontal ml-4 mr-1">
                      
                      <div class="col-12 consultation-port-new">
                        <div class="row"> 
                          <div class="col-9" style="padding-right : 0">
                            <div class="row">
                              <div class="col-md-12">
                                <label class="consultation-label-top">
                                  BOOK APPOINTMENT
                                </label>
                              </div>
                              <div class="col-md-12">
                                <label class="consultation-label-bottom">
                                  Click Preferred Mode of Consultation
                                </label>
                              </div>
                            </div>
                          </div>
                          <div class="col-3" style="padding : 0; font-size : large; color : white">
                            Rs.{{doctor.consultationFees}}/-
                          </div>
                        </div> 
                      </div>
                      
                      <div class="col-12">
                        <div class="row book-appointment-row">
                          <div class="col-3 bookconsultation-div" (click)="openDialog('video', i)">
                            <div class="consultation-border cursor-pointer text-center">
                              <div class="center consultation-icon">
                                <mat-icon>videocam</mat-icon>
                              </div>
                              <label class="image-data">
                                {{doctor.consultationTiming.video.from}} - {{doctor.consultationTiming.video.to}}
                              </label>
                            </div>
                          </div>
                          <div class="col-3 bookconsultation-div" (click)="openDialog('tele', i)">
                            <div  class="consultation-border cursor-pointer text-center">
                              <div class="center consultation-icon">
                                <mat-icon>perm_phone_msg</mat-icon>
                              </div>
                              <label class="image-data">
                                {{doctor.consultationTiming.tele.from}} - {{doctor.consultationTiming.tele.to}}
                              </label>
                            </div>
                          </div>
                          <div class="col-3 bookconsultation-div" (click)="openDialog('physical', i)">
                            <div  class="consultation-border cursor-pointer text-center">
                              <div class="center consultation-icon">
                                <mat-icon>phone_android</mat-icon>
                              </div>
                              <label class="image-data">
                                {{doctor.consultationTiming.physical.from}} - {{doctor.consultationTiming.physical.to}}
                              </label>
                            </div>
                          </div>
                          <div class="col-3 bookconsultation-div" (click)="openDialog('chat', i)">
                            <div  class="consultation-border cursor-pointer text-center">
                              <div class="center consultation-icon">
                                <mat-icon>person_add</mat-icon>
                              </div>
                              <label class="image-data ">
                                {{doctor.consultationTiming.chat.from}} - {{doctor.consultationTiming.chat.to}}
                              </label>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-12 emergency-section">
                        <div class="row">
                          <div class="col-12 cursor-pointer" (click)="openDialog('emergency', i)">
                            <div class="row cursor-pointer">
                              <div class="col-md-4 mt-1">
                                <img
                                  src="./assets/img/consulation/blood-test/emergency1.jpg"
                                  class="emergency-image-horizontal"
                                >
                              </div>
                              <div class="col-md-2"></div>
                              <div class="col-6 mt-1 cursor-pointer">
                                <div class="row">
                                  <div class="col-12 emergency-fee mt-1">
                                    <label class="emergency-fee">Fee : {{doctor.emergencyFees}}/-</label>
                                  </div>
                                  <div class="col-12 emergency-time-div" style="margin-top : -5px">
                                    <label class="emergency-time">24 hrs</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>   
                    </div>
                  </div>
                </div>
                <mat-divider></mat-divider>
                <div class="row">
                  <div class="col-md-4 col-lg-3">
                    <div class="center">
                      <label class="bottom-view-details" (click)="knowMore(i)">View profile</label>
                    </div>
                  </div>
                  <div class="col-md-4 col-lg-5">
                    <div class="center ">
                      <label class="bottom-view-feedback">40 Feedbacks</label>
                    </div>
                  </div>
                  <div class="col-4 logo-div">
                    <img
                      src="./assets/img/consulation/logo.png"
                      class="logo"
                      style="margin-top: 5px; width : 35px"
                    >
                  </div>  
                </div>
              </mat-card>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-1"></div>
    <div class="not-found col-md-10" *ngIf="!containDoctor">
      <h3>Thanks for showing interest in HealthCrum. Currently we do not have any specialist at your location and we 
      promise to reach at every corner of this country as soon as possible.
      </h3>
    </div>
  </div>
</div>
